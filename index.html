<!Doctype html>
<head>
	<style>
		body{
			padding: 20px 0 0 20px;
		}
		p{
			width: 50%;
		}
		button{
			margin-bottom: 30px;
		}
		.messages{
			border-bottom: 1px solid #6666ff;
		}
		#speed{
			width: 20em;
		}
	</style>
</head>


<body>

	<div class="messages">
		<p id="email1">
		Dear Professor Radley after reviewing the notes from class on Monday. | There was something that seemed odd to me. | In Charlotte Perkins Gilman. | The ending can be interpreted in different ways correct. |  In my notes I wrote that the ending can be seen as both a triumph for the protagonist as well as a tragic end. |  A float representing the rate value. | It can range between 0.1 (lowest) and 10 (highest), with 1 being the default pitch for the current platform or voice, which should correspond to a normal speaking rate. |  Other values act as a percentage relative to this, so for example 2 is twice as fast, 0.5 is half as fast, etc. 	| 	
		<br /><br/>
		Thank you in advance.
		</p>
		<button type="button" id="email1Btn"  onclick="readMyEmail('email1')">Read my email</button>
		
		<button type="button" id="emailBtnSTOP" onclick="readMyEmailSTOP('email1')">Stop</button>
		<input id="speed" type="range" min=".8" max="3" value="1" step=".1" onchange="changeSpeed(this.value)" />
		<span id="range">1</span>
		<br>
		<button type="button" id="email1Btn"  onclick="Rewind()">Rewind</button>
		<button type="button" id="email1Btn"  onclick="Fastfoward()">Fastfoward</button>
	</div>

	

	<script type="text/javascript">


		var speed = 1.0;	
		var emailBody = "";
		var period = [0];
		var periodIndex = 0;
		var index2 = 0;
		var index3 = 0;


		function isNumeric(n) {
		  return !isNaN(parseFloat(n)) && isFinite(n);
		}
		function changeSpeed(newValue){
			document.getElementById("range").innerHTML=newValue;
			window.speechSynthesis.cancel(res);
			index3 = index3 + index2;
			speed =  parseFloat(newValue);
			read(res);	
		}

		
 		function Rewind(){
 			periodIndex = periodIndex - 1;
 			index3 = period[periodIndex];
 			window.speechSynthesis.cancel(res);
 			res = emailBody.slice(index3, emailBody.length);
 			read(res);	
 		}
 		function Fastfoward(){
 			index3 = period[periodIndex];
 			periodIndex = periodIndex + 1;
 			window.speechSynthesis.cancel(res);
 			res = emailBody.slice(index3, emailBody.length);
 			read(res);	
 		}


 		//READING
 		// readMyEmail()
 		// 		- finds all indexes of '.' and records them in array period
 		// 			as well as create a string from the text body
 		// 		Parameter
 		// 			- "targetEmail" is the id if the text body
 		// 		Uses variables
 		// 			- emailBody, period
 		// 
 		// read()
 		// 		- reads the text as well as keep and updated index on where the TTS is in the text
 		// 		Parameter
 		// 			- "text" is a text body as a sting
 		// 		Uses variables
 		// 			- index2, index3, period, periodIndex, res
 		// 		Logic
 		// 			- Reads the text
 		// 			- At each boundary (space between words) that is passed
 		// 					-  we subtratract index2 from index3 then update index3 by adding the new indexvalue after a boundary occures update (the indexvalue TTS in the orgainal text body emailBody). We doe this by first subtracting index2 from index3 because otherwise the indexvalue if index (index same value as index2) would be added twice to index 3. Then we compare index3 to the values of period, we do this comparision to check if index3 is larger than any  period values, and if it did, that means that a period was passed
 		// 			
 		// 
		function readMyEmail(targetEmail){
			emailBody = document.getElementById(targetEmail).innerText;
			for (i =0 ; i < emailBody.length; i++){
				if (emailBody[i] =='.' && !isNumeric(emailBody[i+1]) ){
					period.push(i);
				}
			}
			read(emailBody);
		}
		var res = emailBody.slice(0,0);
		function read(text){
			var msg = new SpeechSynthesisUtterance(text);
			msg.rate = speed;
			window.speechSynthesis.speak(msg);
			msg.onboundary = function(event) {
			    var length = text.length;
			    var index = event.charIndex;
			    var chr = text.charAt(index);
			    // subtract index2 first because then the current indexvalue would be added twice.  
			   	index3 = index3 - index2 + index;
			   	index2 = index;
			    if (index3 > period[periodIndex]) {
			    	periodIndex = periodIndex + 1;
			    } 
				res = text.slice(index, length);
			};
		}
		function readMyEmailSTOP(targetEmail){
			var emailBody = document.getElementById(targetEmail).innerText;
			var msg = new SpeechSynthesisUtterance(emailBody);
			window.speechSynthesis.cancel(msg);
			location.reload();
		}
		

		// Vocab
		// 		- var period = is an array that lists all of the indexes that has a period.
		// 		- var periodIndex = is number that 
		// 		- var emailBody = is your entire text 

		
		//SPEED
		// changeSpeed()
		// 		- changes the rate of TTS on the spot, using information from the slider
		// 		Uses variables
		// 			- index2, index3
		// 		Parameter
		// 			-  "NewWavlue" is the numeric value taken the slider
		// 		Logic
		//			- changeSpeed is called when the slider is used, changeSpeed then takes the 
		// 			number that the slider was changed to, stops the text from reading, changes 
		// 			the speed, and starts reading the text again
		// 		Returns 
		// 			- the text with a new reading rate

		//SKIPPING
		// Rewind() OR Fastfoward()
		// 		- finds the next period to skip ahead or back to 
		// 		Uses variables
		// 			- period, periodIndex, emailBody, index3
		//	 	Logic
		// 			- Is called when rewind/fastfoward button clicked
		// 			- index3 is updated and set equal to periodIndex AND if rewind -1 to periodIndex / if 
		// 				fastfoward +1 to periodIndex
		//			- The # pulled from period[periodIndex] will be a index value in emailBody that  
		// 				will tell where the next "." you are skipping to
		//			- stops the text from reading, updates the starting index value using 
		// 				emailBody and resets res, then starts reading the text again 
		// 		Returns 
		// 			- a new text starting at the sentence before or after the currant instant in text.  


		

		


		//STOP


	</script>

</body>
</html>
